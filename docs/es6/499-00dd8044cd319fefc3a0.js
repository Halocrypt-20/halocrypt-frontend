(window.webpackJsonp=window.webpackJsonp||[]).push([[499],{499:(e,t,i)=>{"use strict";i.r(t),i.d(t,{UserProfileEditor:()=>_});var r=i(386),s=i(326),n=i(659),o=i(264),a=i(649),c=i(77),l=i(804),d=i(67);function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const u=l.h.getStore();class _ extends s.Profile{constructor(...e){super(...e),h(this,"helpText","Click on a property to edit"),h(this,"editableFieldsValidatorFunctions",{name:o.u2,ig_user_id:o.oS,email:o.sQ,school:o.oS,current_level:o.If,last_question_answered_at:o.If}),h(this,"_promiseErrorHandler",()=>this.setState({error:"Unknown error occured",isEditing:!0})),h(this,"__confirmAction",e=>{const t=e.target.dataset.action;this.setState({confirmAction:t,isConfirmed:!1})}),h(this,"__executeConfirmedAction",()=>{const e=this.state.confirmAction;if(this.setState({isConfirmed:!0,workProgress:"Making irreversible changes to the database...."}),"delete"===e)return(0,a.V)(c.SA.deleteUser,{user:this.state.__receivedData.id,field:this.state.fieldEdited}).then(e=>{const t=e.error||e.data.error;if(t)return this.setState({error:t,workProgress:null,confirmAction:null});this.props.closeProfileEditor(this.state.__receivedData)}).catch(this._promiseErrorHandler);if("qualification-toggle"==e){const e=this.state.__receivedData.is_disqualified?"requalify":"disqualify",t=c.SA[e];return(0,a.V)(t,{user:this.state.__receivedData.id}).then(this.__cxResponses).catch(this._promiseErrorHandler)}}),h(this,"__cxResponses",e=>{this.setState({confirmAction:null}),this.__onResponse(e)}),h(this,"syncProfileInfoWithServer",e=>{const t=this.state.fieldEdited;"last_question_answered_at"!==t&&"current_level"!==t||(e=e.length>1?e.replace(/^0+/,""):e);const i=this.editableFieldsValidatorFunctions[t](e);if(!i.valid)return this.setState({error:i.error,workProgress:null,isEditing:!0});this.setState({workProgress:"Syncing new data with the server..."}),(0,a.V)(c.SA.adminEditUserData,{user:this.state.__receivedData.id,field:t,new_value:(e||"").trim()}).then(this.__onResponse).catch(this._promiseErrorHandler)}),h(this,"__closeAction",()=>this.setState({confirmAction:null,isConfirmed:null}))}_getKeys(e){return["id","has_verified_email"].concat((0,n.Z)(this.editableFieldsValidatorFunctions))}_isAllowedToEditProfile(){return!0}_getActionPanel(){if(!u.isLoggedIn)return;const e=this.state.__receivedData;return e&&e.id!==u.userData.id?(0,r.az)("div",{children:[(0,r.az)("div",{class:"heading-text clr",style:{fontSize:"2rem"},children:"DANGER SECTION"}),(0,r.az)("span",{"data-action":"delete",class:"hoverable action-button act",onClick:this.__confirmAction,children:"Delete Account"}),(0,r.az)("span",{"data-action":"qualification-toggle",class:"hoverable action-button act",onClick:this.__confirmAction,children:[e.is_disqualified?"Requalify":"Disqualify"," Account"]})]}):void 0}render(e,t){const i=t.confirmAction;if(!i)return super.render(e,t);{const e=t.__receivedData,s=e.is_disqualified,n=e.id,o=e.name;if(!t.isConfirmed)return(0,r.az)(r.HY,{children:[(0,r.az)("div",{class:"mask",onClick:this.__closeAction}),(0,r.az)(d.GI,{close:this.__executeConfirmedAction,title:"Woah there..",errorHead:(0,r.az)("span",{children:["Are you sure you want to",(0,r.az)("span",{style:{color:"red"},children:" "+("delete"===i?i:s?"Requalify":"Disqualify").toUpperCase()}),` ${n}( ${o} ) ?`]})}),";"]});if(t.workProgress)return(0,r.az)("div",{children:t.workProgress})}}}}}]);