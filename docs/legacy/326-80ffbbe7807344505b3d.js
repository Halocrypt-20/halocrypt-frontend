(window.webpackJsonp=window.webpackJsonp||[]).push([[326],{1326:function(e,t,r){"use strict";r.r(t);var n=r(3109),a=r.n(n),i=(r(5666),r(4435)),s=r.n(i),o=r(1161),l=r.n(o),c=r(2991),d=r.n(c),u=r(5843),f=r.n(u),h=r(7766),v=r.n(h),p=r(1222),g=r.n(p),_=r(4382),m=r.n(_),E=r(7672),z=r.n(E),y=r(2386),b={id:"Username",current_level:"Level",ig_user_id:"Insta",is_admin:"Player Type"},w=function(e){function t(){for(var t,r,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=e.call.apply(e,v()(t=[this]).call(t,a))||this,z()(g()(r),"__sendSuccess",(function(){var e;return f()(e=r.state.value||"").call(e)&&r.props.onUpdate(r.state.value)})),z()(g()(r),"state",{value:r.props.value||""}),z()(g()(r),"onInput",(function(e){return r.setState({value:e.target.value})})),r}return m()(t,e),t.prototype.render=function(e,t){var r=e.detailName,n=b[r]||r;return(0,y.az)(y.HY,{children:[(0,y.az)("div",{class:"mask"}),(0,y.az)("div",{class:"app-popup profile-info-updater",children:[(0,y.az)("div",{class:"heading-text clr",style:{marginTop:"5px",marginBottom:"10px"},children:["Edit ",n]}),e.progress&&(0,y.az)("div",{children:e.progress}),(0,y.az)("form",{action:"javascript:",onSubmit:this.__sendSuccess,children:[(0,y.az)("input",{type:"email"===r?r:"text",value:t.value,class:"paper-input",style:{width:"80%"},onInput:this.onInput,placeholder:n}),(0,y.az)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,y.az)("span",{class:"action-button hoverable update-action",onClick:this.__sendSuccess,children:"Update"}),(0,y.az)("span",{onClick:e.close,class:"action-button hoverable update-action",children:"Cancel"})]})]})]})]})},t}(y.ZP),P=r(4383),S=r(77),x=r(3735),D=r(9067),A=r(3659),k=r(9264);r.d(t,{Profile:function(){return T},default:function(){return K}});var I=P.h.getStore(),U={},L="heading-text hoverable landing-action-button",T=function(e){function t(){for(var t,r,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=e.call.apply(e,v()(t=[this]).call(t,a))||this,z()(g()(r),"state",{isEditing:!1,fieldEdited:null,__receivedData:r.props.data}),z()(g()(r),"headerText","Profile"),z()(g()(r),"helpText","You can edit your email, instagram and school fields by clicking them"),z()(g()(r),"editableFieldsValidatorFunctions",{ig_user_id:k.oS,email:k.sQ,school:k.oS}),z()(g()(r),"requestEditUserDetail",(function(e){!r.state.isEditing&&r._isAllowedToEditProfile()&&r.setState({isEditing:!0,fieldEdited:e})})),z()(g()(r),"syncProfileInfoWithServer",(function(e){if(!r.state.workProgress){var t,n=r.state.fieldEdited,a=r.editableFieldsValidatorFunctions[n](e);if(a.valid)r.setState({workProgress:"Syncing new data with the server..."}),(0,x.V)(S.EA.edit,{user:r.state.__receivedData.id,field:n,new_value:f()(t=e||"").call(t)}).then(r.__onResponse);else r.setState({error:a.error,workProgress:null})}})),z()(g()(r),"__onResponse",(function(e){if(I.isLoggedIn){var t=e.error||e.data.error;if(t)return r.setState({error:t,workProgress:null});var n=e.data.user_data;r.setState({workProgress:null,isEditing:null,fieldEdited:null,__receivedData:n}),n.id===I.userData.id&&P.h.set("userData",n)}})),z()(g()(r),"_getRequestEditUserDetail",(function(e){return function(){return r.requestEditUserDetail(e)}})),z()(g()(r),"closePrompt",(function(){return r.setState({isEditing:!1,fieldEdited:null})})),z()(g()(r),"resetError",(function(){return r.setState({error:null})})),r}m()(t,e);var r=t.prototype;return r._getKeys=function(e){var t;return v()(t=["name","id","current_level","is_admin","school"]).call(t,(0,A.Z)(e&&e.secure_data||U))},r._getActionPanel=function(){var e=this.state.__receivedData,t=I.isLoggedIn&&I.userData.id;return(0,y.az)("div",{class:"action-buttons-profile",children:(0,y.az)(C,{data:e,currID:t})})},r._isAllowedToEditProfile=function(){var e=I.userData?I.userData.id:null;return this.state.__receivedData.id===e},r.render=function(e,t){var r,n=this,a=t.__receivedData,i=a.secure_data||U;return(0,y.az)("div",{children:[t.isEditing&&(0,y.az)(y.HY,{children:[t.error&&(0,y.az)(D.OK,{errorHead:"Can't edit",close:this.resetError,reason:t.error}),(0,y.az)(w,{progress:this.state.workProgress,close:this.closePrompt,detailName:t.fieldEdited,onUpdate:this.syncProfileInfoWithServer,value:t.__receivedData[t.fieldEdited]||t.__receivedData.secure_data[t.fieldEdited]})]}),(0,y.az)("div",{class:"heading-text bfont",children:this.headerText}),(0,y.az)("div",{style:{fontSize:"0.96rem"},children:this._isAllowedToEditProfile()&&this.helpText}),(0,y.az)("div",{class:"prof-data-box",children:d()(r=this._getKeys(a)).call(r,(function(e){return(0,y.az)(F,{editableFieldsValidatorFunctions:n.editableFieldsValidatorFunctions,x:e,getRequestEditUserDetail:n._getRequestEditUserDetail,data:a,sec:i})}))}),this._getActionPanel()]})},t}(y.wA);function C(e){var t=e.data,r=e.currID;return(0,y.az)(y.HY,{children:[q(t,r)&&(0,y.az)(y.A,{href:"/__admin__",class:L,children:"Admin Panel"}),t.id===r&&[!t.has_verified_email&&(0,y.az)(y.A,{href:"/verify-email",class:L,children:"Verify Email"}),(0,y.az)(y.A,{href:"/logout",class:L,children:"Logout"})]]})}function F(e){var t=e.x,r=e.getRequestEditUserDetail,n=e.data,a=e.sec,i=e.editableFieldsValidatorFunctions;return(0,y.az)("div",{onClick:t in i?r(t):null,class:"prof-container"+(t in i?" hoverable":""),children:[(0,y.az)("div",{class:"heading-text prof-field",children:b[t]||t}),(0,y.az)("div",{class:"prof-field",children:$(n,a,t)})]})}function R(){return V.apply(this,arguments)}function V(){return(V=l()(a().mark((function e(){var t,r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new(s())(y.F0.getQs),r=t.get("id"),!I.isLoggedIn||r!==I.userData.id){e.next=6;break}n=I.userData,e.next=10;break;case 6:return e.next=8,(0,x.A)(S.EA.getUserDetails+"?id="+r);case 8:n=(n=e.sent).data;case 10:if(!n){e.next=12;break}return e.abrupt("return",(function(){return(0,y.az)(T,{data:n})}));case 12:return e.abrupt("return",(function(){return(0,y.az)(D.OK,{errorHead:"Profile Error",reasons:["User does not exist"],close:function(){return(0,y.uX)("/")}})}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t,r){var n=r in e?e[r]:t[r];return"is_admin"===r&&(n=!0===n?"Team Halocrypt":"Player"),"boolean"==typeof n&&(n=""+n),null!=n&&""!==n||(n="N/A"),n}function q(e,t){return e.is_admin&&e.id===t}var H={id:"Loading..",current_level:"Infinity",has_verified_email:null,name:"??"},K=function(){return new(s())(y.F0.getQs).get("id")?(0,y.az)(y.gr,{componentPromise:R,fallbackComponent:function(){return(0,y.az)(T,{data:H})}}):I.isLoggedIn?(0,y.uX)("/profile?id="+I.userData.id):(0,y.uX)("/login")}},9067:function(e,t,r){"use strict";r.d(t,{OK:function(){return g},Pt:function(){return _},GI:function(){return m}});var n=r(2991),a=r.n(n),i=r(7766),s=r.n(i),o=r(1222),l=r.n(o),c=r(4382),d=r.n(c),u=r(7672),f=r.n(u),h=r(1942),v=r.n(h),p=r(2386);function g(e){return(0,p.az)(m,v()(v()({},e),{},{title:"Something Ain't Right"}))}var _=/([^\w]|_)/g,m=function(e){function t(){for(var t,r,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=e.call.apply(e,s()(t=[this]).call(t,a))||this,f()(l()(r),"__id",Math.random()),r}d()(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=document.getElementById(""+this.__id);e&&e.focus()},r.render=function(e){var t;return(0,p.az)("div",{class:"app-popup",children:[(0,p.az)("div",{class:"heading-text clr app-popup-title",children:e.title}),(0,p.az)("div",{children:e.errorHead}),(0,p.az)("div",{class:"err-reasons",children:(0,p.az)("div",{children:a()(t=e.reasons||[]).call(t,(function(e){return(0,p.az)("div",{children:[" - ",e]})}))})}),(0,p.az)("button",{id:this.__id,class:"app-popup-close",onClick:e.close,children:"OK"})]})},t}(p.ZP)},9264:function(e,t,r){"use strict";r.d(t,{Vy:function(){return a},sQ:function(){return s},oS:function(){return o},If:function(){return l},Bj:function(){return c},RX:function(){return d},u2:function(){return u},R0:function(){return f}});r(4916),r(5306);var n=r(9067),a={valid:!0},i={valid:!1};function s(e){return e?a:{error:"Value required"}}var o=function(){return a};function l(e){return(t=+(t=e))==t?a:i;var t}function c(e){return e.length<5?{error:f.pwLength}:a}function d(e){var t=e.length;return t<3||t>30?{error:f.userLength}:e!==e.replace(n.Pt,"")?{error:f.invalidCharacters}:a}function u(e){var t=e.length;return!t||t>30?{error:f.nameLength}:a}var f={userLength:"Username should be between 3 and 30 characters",invalidCharacters:"Username and name can not contain special characters",invalidEmail:"Invalid email",nameLength:"Name should be less than 30 characters and cannot be blank",pwLength:"Password should be longer than 5 characters",pwNomatch:"Passwords do not match"}},5306:function(e,t,r){"use strict";var n=r(7007),a=r(9670),i=r(7908),s=r(7466),o=r(9958),l=r(4488),c=r(1530),d=r(7651),u=Math.max,f=Math.min,h=Math.floor,v=/\$([$&'`]|\d\d?|<[^>]*>)/g,p=/\$([$&'`]|\d\d?)/g;n("replace",2,(function(e,t,r,n){var g=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=n.REPLACE_KEEPS_$0,m=g?"$":"$0";return[function(r,n){var a=l(this),i=null==r?void 0:r[e];return void 0!==i?i.call(r,a,n):t.call(String(a),r,n)},function(e,n){if(!g&&_||"string"==typeof n&&-1===n.indexOf(m)){var i=r(t,e,this,n);if(i.done)return i.value}var l=a(e),h=String(this),v="function"==typeof n;v||(n=String(n));var p=l.global;if(p){var z=l.unicode;l.lastIndex=0}for(var y=[];;){var b=d(l,h);if(null===b)break;if(y.push(b),!p)break;""===String(b[0])&&(l.lastIndex=c(h,s(l.lastIndex),z))}for(var w,P="",S=0,x=0;x<y.length;x++){b=y[x];for(var D=String(b[0]),A=u(f(o(b.index),h.length),0),k=[],I=1;I<b.length;I++)k.push(void 0===(w=b[I])?w:String(w));var U=b.groups;if(v){var L=[D].concat(k,A,h);void 0!==U&&L.push(U);var T=String(n.apply(void 0,L))}else T=E(D,h,A,k,U,n);A>=S&&(P+=h.slice(S,A)+T,S=A+D.length)}return P+h.slice(S)}];function E(e,r,n,a,s,o){var l=n+e.length,c=a.length,d=p;return void 0!==s&&(s=i(s),d=v),t.call(o,d,(function(t,i){var o;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(l);case"<":o=s[i.slice(1,-1)];break;default:var d=+i;if(0===d)return t;if(d>c){var u=h(d/10);return 0===u?t:u<=c?void 0===a[u-1]?i.charAt(1):a[u-1]+i.charAt(1):t}o=a[d-1]}return void 0===o?"":o}))}}))}}]);