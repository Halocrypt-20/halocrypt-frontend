(window.webpackJsonp=window.webpackJsonp||[]).push([[326],{7:(e,t,r)=>{"use strict";r.d(t,{u:()=>d,k:()=>c});var i=r(77),s=r(649),a=r(804),n=r(369);const o=(0,n.Z)({},window.__initConfig);window.__initConfig=null;const l=a.h.getStore(),d=window.requestIdleCallback||window.requestAnimationFrame||window.Promise&&Promise.prototype.then.bind(Promise.resolve())||setTimeout;const c=new class{constructor(){this.pageViewRegistered="register-start",this.registerActionComplete="register-end",this.pageViewLogin="login-start",this.loginActionCompleted="login-end",this.pageViewPlay="play-start",this.accessQuestion="question",this.answeredQuestion="answered",this.leaderboardView="leaderboard",this.profileView="profile",this.passwordResetRequested="password-reset"}__shouldPostLog(){return!1}_admin_getLogs(){if(l.isLoggedIn&&l.userData.is_admin)return(0,s.A)(i.PW.getLogs)}sendUserLog(e){const t="string"==typeof e?{type:e}:e,r=(0,n.Z)({},t,o);this.__shouldPostLog()?d(()=>(0,s.V)(i.PW.addLog,r)):console.log("prod log post ->",r)}};window.onerror=(e,t,r,i,s)=>{const a=s||{};e=e||a.message||"";const n=s.line||a.message||0,o=s.column||0,l=a.script||"",d=a.stackTrace||a.stack||"",u=Date.now(),h=location.href;c.sendUserLog({type:"js-error",timestamp:u,message:e,line:n,column:o,script:l,stack:d,url:h,source:t})}},326:(e,t,r)=>{"use strict";r.r(t);var i=r(386);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const a={id:"Username",current_level:"Level",ig_user_id:"Insta",is_admin:"Player Type"};class n extends i.ZP{constructor(...e){super(...e),s(this,"__sendSuccess",()=>(this.state.value||"").trim()&&this.props.onUpdate(this.state.value)),s(this,"state",{value:""}),s(this,"onInput",e=>this.setState({value:e.target.value}))}render(e,t){const r=e.detailName,s=a[r]||r;return(0,i.az)(i.HY,{children:[(0,i.az)("div",{class:"mask"}),(0,i.az)("div",{class:"app-popup profile-info-updater",children:[(0,i.az)("div",{class:"heading-text clr",style:{marginTop:"5px",marginBottom:"10px"},children:["Edit ",s]}),e.progress&&(0,i.az)("div",{children:e.progress}),(0,i.az)("form",{action:"javascript:",onSubmit:this.__sendSuccess,children:[(0,i.az)("input",{type:"email"===r?r:"text",value:t.value,class:"paper-input",style:{width:"80%"},onInput:this.onInput,placeholder:s}),(0,i.az)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,i.az)("span",{class:"action-button hoverable update-action",onClick:this.__sendSuccess,children:"Update"}),(0,i.az)("span",{onClick:e.close,class:"action-button hoverable update-action",children:"Cancel"})]})]})]})]})}}var o=r(804),l=r(77),d=r(649),c=r(67),u=r(659),h=r(7),g=r(264);function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{default:()=>S});const m=o.h.getStore(),f={},v={ig_user_id:g.oS,email:g.sQ,school:g.oS},w="heading-text hoverable landing-action-button";class _ extends i.wA{constructor(e){super(e),p(this,"requestEditUserDetail",e=>{!this.state.isEditing&&m.isLoggedIn&&this.setState({isEditing:!0,fieldEdited:e})}),p(this,"syncProfileInfoWithServer",e=>{if(this.state.workProgress)return;const t=this.state.fieldEdited,r=v[t](e);r.valid?(this.setState({workProgress:"Syncing new data with the server..."}),(0,d.V)(l.EA.edit,{user:m.userData.id,field:t,new_value:(e||"").trim()}).then(e=>{const t=e.error||e.data.error;if(t)return this.setState({error:t,workProgress:null});this.setState({workProgress:null,isEditing:null,fieldEdited:null});const r=e.data.user_data;o.h.set("userData",r),this.setState({__receivedData:r})})):this.setState({error:r.error,workProgress:null})}),p(this,"_getRequestEditUserDetail",e=>()=>this.requestEditUserDetail(e)),p(this,"closePrompt",()=>this.setState({isEditing:!1,fieldEdited:null})),p(this,"resetError",()=>this.setState({error:null})),this.state={isEditing:!1,fieldEdited:null,__receivedData:e.data}}render(e,t){const r=t.__receivedData,s=r.secure_data||f,o=m.isLoggedIn&&m.userData.id;return(0,i.az)("div",{children:[t.isEditing&&(0,i.az)(i.HY,{children:[t.error&&(0,i.az)(c.OK,{errorHead:"Can't edit",close:this.resetError,reason:t.error}),(0,i.az)(n,{progress:this.state.workProgress,close:this.closePrompt,detailName:t.fieldEdited,onUpdate:this.syncProfileInfoWithServer})]}),(0,i.az)("div",{class:"heading-text bfont",children:"Profile"}),(0,i.az)("div",{style:{fontSize:"0.96rem"},children:"You can edit your email, instagram and school fields by clicking them"}),(0,i.az)("div",{class:"prof-data-box",children:["name","id","current_level","is_admin","school"].concat((0,u.Z)(s)).map(e=>function(e,t,r,s){return(0,i.az)("div",{onClick:e in v?t(e):null,class:"prof-container"+(e in v?" hoverable":""),children:[(0,i.az)("div",{class:"heading-text prof-field",children:a[e]||e}),(0,i.az)("div",{class:"prof-field",children:P(r,s,e)})]})}(e,this._getRequestEditUserDetail,r,s))}),(0,i.az)("div",{class:"action-buttons-profile",children:(0,i.az)(z,{data:r,currID:o})})]})}}function z(e){const t=e.data,r=e.currID;return(0,i.az)(i.HY,{children:[y(t,r)&&(0,i.az)(i.A,{href:"/__admin__",class:w,children:"Admin Panel"}),t.id===r&&[!t.has_verified_email&&(0,i.az)(i.A,{href:"/verify-email",class:w,children:"Verify Email"}),(0,i.az)(i.A,{href:"/logout",class:w,children:"Logout"})]]})}async function b(){const e=new URLSearchParams(i.F0.getQs).get("id");let t;return m.isLoggedIn&&e===m.userData.id?t=m.userData:(t=await(0,d.A)(`${l.EA.getUserDetails}?id=${e}`),t=t.data,h.k.sendUserLog({type:h.k.profileView,userViewed:t.id})),t?()=>(0,i.az)(_,{data:t}):()=>(0,i.az)(c.OK,{errorHead:"Profile Error",reasons:["User does not exist"],close:()=>(0,i.uX)("/")})}function P(e,t,r){let i=r in e?e[r]:t[r];return null==i&&(i="N/A"),"is_admin"===r&&(i=!0===i?"Team Halocrypt":"Player"),i}function y(e,t){return e.is_admin&&e.id===t}const L={id:"Loading..",current_level:"Infinity",has_verified_email:null,name:"??"},S=()=>new URLSearchParams(i.F0.getQs).get("id")?(0,i.az)(i.gr,{componentPromise:b,fallbackComponent:()=>(0,i.az)(_,{data:L})}):m.isLoggedIn?(0,i.uX)("/profile?id="+m.userData.id):(0,i.uX)("/login")},67:(e,t,r)=>{"use strict";r.d(t,{OK:()=>s,Pt:()=>a});var i=r(386);function s(e){return(0,i.az)(n,{...Object.assign({},e,{title:"Something Ain't Right"})})}const a=/([^\w]|_)/g;function n(e){return(0,i.az)("div",{class:"app-popup",children:[(0,i.az)("div",{class:"heading-text clr app-popup-title",children:e.title}),(0,i.az)("div",{children:e.errorHead}),(0,i.az)("div",{class:"err-reasons",children:(0,i.az)("div",{children:e.reasons.map(e=>(0,i.az)("div",{children:[" - ",e]}))})}),(0,i.az)("button",{class:"app-popup-close",onClick:e.close,children:"OK"})]})}},264:(e,t,r)=>{"use strict";r.d(t,{Vy:()=>s,sQ:()=>a,oS:()=>n,Bj:()=>o,RX:()=>l,u2:()=>d,R0:()=>c});var i=r(67);const s={valid:!0};function a(e){return e?s:{error:"Value required"}}const n=()=>s;function o(e){return e.length<5?{error:c.pwLength}:s}function l(e){const t=e.length;return t<3||t>30?{error:c.userLength}:e!==e.replace(i.Pt,"")?{error:c.invalidCharacters}:s}function d(e){const t=e.length;return!t||t>30?{error:c.nameLength}:s}const c={userLength:"Username should be between 3 and 30 characters",invalidCharacters:"Username and name can not contain special characters",invalidEmail:"Invalid email",nameLength:"Name should be less than 30 characters and cannot be blank",pwLength:"Password should be longer than 5 characters",pwNomatch:"Passwords do not match"}}}]);